┌─────────────────────────────────────────────────────────────────┐
│                     USER INTERFACE LAYER                         │
│              (Web app / Design prompt interface)                 │
└──────────────────────────┬──────────────────────────────────────┘
                           │
┌──────────────────────────▼──────────────────────────────────────┐
│                     API GATEWAY LAYER                            │
│                    (FastAPI endpoints)                           │
└──────────────────────────┬──────────────────────────────────────┘
                           │
┌──────────────────────────▼──────────────────────────────────────┐
│                  DESIGN ENGINE LAYER                             │
│                                                                   │
│  ┌─────────────┐  ┌──────────────┐  ┌──────────────────┐        │
│  │ Prompt      │  │ LLM Intent   │  │ Constraint Graph │        │
│  │ Processing  │→ │ Extraction   │→ │ Generation       │        │
│  │ (GOD Prompt)│  │ (Claude 3.5) │  │ (NetworkX)       │        │
│  └─────────────┘  └──────────────┘  └──────────────────┘        │
│         │                                      │                  │
│         └──────────────┬───────────────────────┘                  │
│                        ▼                                          │
│              ┌──────────────────┐                                │
│              │ Constraint       │                                │
│              │ Solver           │                                │
│              │ (OR-Tools)       │                                │
│              └──────────────────┘                                │
└──────────────────────────┬──────────────────────────────────────┘
                           │
┌──────────────────────────▼──────────────────────────────────────┐
│              SVG CODE GENERATION LAYER                            │
│                  (LLM generates SVG)                              │
│  • Primitives: rect, circle, path, text, g                       │
│  • Transforms: translate, rotate, scale                          │
│  • Output: Valid SVG XML                                         │
└──────────────────────────┬──────────────────────────────────────┘
                           │
┌──────────────────────────▼──────────────────────────────────────┐
│              RENDERING LAYER                                     │
│                                                                   │
│  ┌──────────────┐              ┌──────────────┐                 │
│  │ Skia Canvas  │──────────────│ Puppeteer    │                 │
│  │ (Primary)    │ (Vector/     │ (Fallback)   │                 │
│  │ Node.js      │  Raster)     │ Chrome       │                 │
│  └──────────────┘              └──────────────┘                 │
│         │                              │                         │
│         └──────────────┬───────────────┘                         │
│                        ▼                                         │
│         Output Formats: PNG, WebP, SVG, PDF                     │
└──────────────────────────┬──────────────────────────────────────┘
                           │
┌──────────────────────────▼──────────────────────────────────────┐
│            VERIFICATION & VALIDATION LAYER                       │
│                                                                   │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐          │
│  │ Layout       │  │ Text         │  │ Color        │          │
│  │ Integrity    │  │ Readability  │  │ Contrast     │          │
│  │ Checks       │  │ (WCAG)       │  │ (WCAG AAA)   │          │
│  └──────────────┘  └──────────────┘  └──────────────┘          │
│         │                │                    │                  │
│         └────────────────┴────────────────────┘                  │
│                          ▼                                       │
│                  Pass/Fail Decision                              │
│         (If fail: trigger refinement loop)                       │
└──────────────────────────┬──────────────────────────────────────┘
                           │
┌──────────────────────────▼──────────────────────────────────────┐
│              STORAGE & DELIVERY LAYER                             │
│                                                                   │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐          │
│  │ Design Specs │  │ Rendered     │  │ Audit Trail  │          │
│  │ (PostgreSQL) │  │ Assets (S3)  │  │ (PostgreSQL) │          │
│  └──────────────┘  └──────────────┘  └──────────────┘          │
└─────────────────────────────────────────────────────────────────┘
